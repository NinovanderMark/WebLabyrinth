(()=>{"use strict";var e={937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;t.Color=function(e,t,r){this.hue=e,this.saturation=t,this.lightness=r}},934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var i=r(993),s=function(){function e(e,t){this.worldMap=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],this.currentTileX=0,this.currentTileY=0,this.currentTime=0,this.previousTime=0,this.renderer=e,this.input=t,this.player=new i.Player(18,19)}return e.prototype.tick=function(){this.gameStep(),this.renderer.render(this),window.requestAnimationFrame(this.tick.bind(this))},e.prototype.gameStep=function(){if(this.input.keyQueue.length>0&&(console.log(this.input.keyQueue),null!=this.input.keyQueue.find((function(e){return"m"===e}))&&this.renderer.toggleMap(),this.input.clearQueue()),this.input.anyDirectional()){this.input.leftPressed?this.player.rotateBy(1):this.input.rightPressed&&this.player.rotateBy(-1);var e=0,t=0;if(this.input.upPressed)t+=this.player.direction.y*this.player.movementSpeed,e+=this.player.direction.x*this.player.movementSpeed;else{if(!this.input.downPressed)return;t-=this.player.direction.y*this.player.movementSpeed,e-=this.player.direction.x*this.player.movementSpeed}var r=this.player.posX+e,i=this.player.posY+t;i>this.worldMap.length||i<0||r>this.worldMap[0].length||r<0||(this.currentTileX=Math.floor(r),this.currentTileY=Math.floor(i),0===this.worldMap[this.currentTileY][this.currentTileX]&&(this.player.posX=r,this.player.posY=i))}},e}();t.Game=s},322:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;var r=function(){function e(){this.upPressed=!1,this.downPressed=!1,this.leftPressed=!1,this.rightPressed=!1,this.keyQueue=[]}return e.prototype.attachEventListeners=function(e){var t=this;e.addEventListener("keydown",(function(e){"ArrowLeft"===e.key&&(t.leftPressed=!0),"ArrowRight"===e.key&&(t.rightPressed=!0),"ArrowUp"===e.key&&(t.upPressed=!0),"ArrowDown"===e.key&&(t.downPressed=!0)})),e.addEventListener("keyup",(function(e){"ArrowLeft"===e.key&&(t.leftPressed=!1),"ArrowRight"===e.key&&(t.rightPressed=!1),"ArrowUp"===e.key&&(t.upPressed=!1),"ArrowDown"===e.key&&(t.downPressed=!1),1===e.key.length&&t.keyQueue.push(e.key)}))},e.prototype.anyDirectional=function(){return!!(this.upPressed||this.downPressed||this.leftPressed||this.rightPressed)},e.prototype.clearQueue=function(){this.keyQueue=[]},e}();t.Input=r},993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var i=r(51),s=function(){function e(e,t){this.movementSpeed=.05,this.posX=e,this.posY=t,this.direction=new i.Vector(0,-1),this.plane=new i.Vector(.66,0)}return e.prototype.rotateBy=function(e){this.direction.rotateBy(e),this.plane.rotateBy(e)},e}();t.Player=s},983:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var i=r(937),s=function(){function e(e,t,r){this.screenWidth=e,this.screenHeight=t,this.canvas=r,this.canvas.width=this.screenWidth,this.canvas.height=this.screenHeight;var i=this.canvas.getContext("2d");if(null==i)throw new Error("Unable to get 2D rendering context from Canvas");this.drawContext=i}return e.prototype.toggleMap=function(){this.mapVisible=!this.mapVisible},e.prototype.render=function(e){this.renderGame(e),this.mapVisible&&this.renderMap(e)},e.prototype.renderGame=function(e){this.drawContext.fillStyle="#000",this.drawContext.fillRect(0,0,this.screenWidth,this.screenHeight);for(var t=0;t<this.screenWidth;t++){var r,i,s,n,o,a,h=2*t/this.screenWidth-1,l=e.player.direction.x+e.player.plane.x*h,p=e.player.direction.y+e.player.plane.y*h,d=Math.floor(e.player.posX),u=Math.floor(e.player.posY),c=Math.abs(1/l),y=Math.abs(1/p),f=0;for(l<0?(n=-1,r=(e.player.posX-d)*c):(n=1,r=(d+1-e.player.posX)*c),p<0?(o=-1,i=(e.player.posY-u)*y):(o=1,i=(u+1-e.player.posY)*y);0===f;)r<i?(r+=c,d+=n,a=0):(i+=y,u+=o,a=1),e.worldMap[u][d]>0&&(f=1);s=0===a?(d-e.player.posX+(1-n)/2)/l:(u-e.player.posY+(1-o)/2)/p;var w=Math.floor(this.screenHeight/s),v=-w/2+this.screenHeight/2;v<0&&(v=0);var g=w/2+this.screenHeight/2;g>=this.screenHeight&&(g=this.screenHeight-1);var k=this.getBlockColor(e.worldMap[u][d]);1===a&&(k.lightness=k.lightness/2),this.drawContext.strokeStyle="hsl("+k.hue+","+k.saturation+"%,"+k.lightness+"%)",this.drawContext.beginPath(),this.drawContext.moveTo(t,v),this.drawContext.lineTo(t,g),this.drawContext.stroke()}},e.prototype.renderMap=function(e){var t=10;this.drawContext.strokeStyle="#f0f";for(var r=0;r<e.worldMap.length;r++)for(var i=0;i<e.worldMap[r].length;i++){var s=this.getBlockColor(e.worldMap[r][i]);this.drawContext.fillStyle="hsl("+s.hue+","+s.saturation+"%,"+s.lightness+"%)",this.drawContext.fillRect(i*t,r*t,t,t),e.currentTileX===i&&e.currentTileY===r&&this.drawContext.strokeRect(i*t,r*t,t,t)}var n=e.player.posX*t,o=e.player.posY*t;this.drawContext.strokeStyle="#fff",this.drawContext.beginPath(),this.drawContext.arc(n,o,5,0,2*Math.PI),this.drawContext.stroke(),this.drawContext.beginPath(),this.drawContext.moveTo(n,o),this.drawContext.lineTo(n+e.player.direction.x*t,o+e.player.direction.y*t),this.drawContext.stroke()},e.prototype.getBlockColor=function(e){var t=0,r=100,s=50;switch(e){case 0:r=0,s=0;break;case 1:t=0;break;case 2:t=120;break;case 3:t=240;break;case 4:r=0,s=100;break;default:t=60}return new i.Color(t,r,s)},e}();t.Renderer=s},51:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.rotateBy=function(e){e=-e*(Math.PI/180);var t=Math.cos(e),r=Math.sin(e),i=Math.round(1e4*(this.x*t-this.y*r))/1e4,s=Math.round(1e4*(this.x*r+this.y*t))/1e4;this.x=i,this.y=s},e}();t.Vector=r}},t={};function r(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}(()=>{var e=r(934),t=r(322),i=r(983),s=document.getElementById("canvas"),n=new t.Input;n.attachEventListeners(document.getElementsByTagName("body")[0]);var o=new i.Renderer(1024,768,s);new e.Game(o,n).tick()})()})();
//# sourceMappingURL=main.167ce79bf1f9b7749914.js.map