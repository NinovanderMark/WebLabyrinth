(()=>{"use strict";var e={937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;t.Color=function(e,t,r){this.hue=e,this.saturation=t,this.lightness=r}},934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var i=r(993),s=function(){function e(e,t){this.worldMap=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,3,0,0,0,2],[4,0,0,0,0,0,0,2,2,2,2,2,2,0,0,3,0,3,3,3,0,0,0,2],[4,0,3,3,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,3,0,0,0,2],[4,0,3,3,0,0,2,2,0,2,2,0,2,0,0,3,3,3,0,3,0,0,0,2],[4,0,3,3,0,0,2,0,0,0,2,0,2,0,0,3,0,0,0,3,0,0,0,2],[4,0,3,3,0,0,2,0,0,0,0,0,2,0,0,3,0,3,3,3,0,0,0,2],[4,0,0,0,0,0,2,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,2],[4,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,2],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[4,0,1,0,0,1,0,0,0,0,0,5,5,5,5,5,0,0,0,0,0,0,0,2],[4,0,0,0,0,1,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,2],[4,0,0,0,0,1,0,0,0,0,0,5,5,0,0,5,0,0,0,0,0,0,0,2],[4,0,1,1,1,1,0,0,0,0,0,0,5,0,0,5,0,0,0,0,0,0,0,2],[4,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,1,0,0,1,1,2],[4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2],[4,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,1,0,0,1,1,2],[4,4,0,0,0,0,5,0,4,4,0,4,4,4,0,0,0,0,1,0,0,0,0,2],[4,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,1,0,0,1,1,2],[4,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2],[4,4,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,1,0,0,0,0,2],[4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2],[4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],this.ceiling=5,this.floor=2,this.currentTileX=0,this.currentTileY=0,this.currentTime=0,this.previousTime=0,this.renderer=e,this.input=t,this.player=new i.Player(17,19)}return e.prototype.tick=function(){this.gameStep(),this.renderer.render(this),window.requestAnimationFrame(this.tick.bind(this))},e.prototype.gameStep=function(){if(this.input.keyQueue.length>0&&(console.log(this.input.keyQueue),null!=this.input.keyQueue.find((function(e){return"m"===e}))&&this.renderer.toggleMap(),this.input.clearQueue()),this.input.anyDirectional()){this.input.leftPressed?this.player.rotateBy(1.5):this.input.rightPressed&&this.player.rotateBy(-1.5);var e=0,t=0;if(this.input.upPressed)t+=this.player.direction.y*this.player.movementSpeed,e+=this.player.direction.x*this.player.movementSpeed;else{if(!this.input.downPressed)return;t-=this.player.direction.y*this.player.movementSpeed,e-=this.player.direction.x*this.player.movementSpeed}var r=this.player.posX+e,i=this.player.posY+t;i>this.worldMap.length||i<0||r>this.worldMap[0].length||r<0||(this.currentTileX=Math.floor(r),this.currentTileY=Math.floor(i),0===this.worldMap[this.currentTileY][this.currentTileX]&&(this.player.posX=r,this.player.posY=i))}},e}();t.Game=s},322:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;var r=function(){function e(){this.upPressed=!1,this.downPressed=!1,this.leftPressed=!1,this.rightPressed=!1,this.keyQueue=[]}return e.prototype.attachEventListeners=function(e){var t=this;e.addEventListener("keydown",(function(e){"ArrowLeft"===e.key&&(t.leftPressed=!0),"ArrowRight"===e.key&&(t.rightPressed=!0),"ArrowUp"===e.key&&(t.upPressed=!0),"ArrowDown"===e.key&&(t.downPressed=!0)})),e.addEventListener("keyup",(function(e){"ArrowLeft"===e.key&&(t.leftPressed=!1),"ArrowRight"===e.key&&(t.rightPressed=!1),"ArrowUp"===e.key&&(t.upPressed=!1),"ArrowDown"===e.key&&(t.downPressed=!1),1===e.key.length&&t.keyQueue.push(e.key)}))},e.prototype.anyDirectional=function(){return!!(this.upPressed||this.downPressed||this.leftPressed||this.rightPressed)},e.prototype.clearQueue=function(){this.keyQueue=[]},e}();t.Input=r},993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var i=r(51),s=function(){function e(e,t){this.movementSpeed=.05,this.posX=e,this.posY=t,this.direction=new i.Vector(0,-1),this.plane=new i.Vector(.66,0)}return e.prototype.rotateBy=function(e){this.direction.rotateBy(e),this.plane.rotateBy(e)},e}();t.Player=s},983:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var i=r(937),s=function(){function e(e,t,r,i){this.texWidth=64,this.texHeight=64,this.screenWidth=e,this.screenHeight=t,this.textures=i,this.canvas=r,this.canvas.width=this.screenWidth,this.canvas.height=this.screenHeight;var s=this.canvas.getContext("2d");if(null==s)throw new Error("Unable to get 2D rendering context from Canvas");this.drawContext=s,this.drawContext.imageSmoothingEnabled=!1}return e.prototype.toggleMap=function(){this.mapVisible=!this.mapVisible},e.prototype.render=function(e){this.drawContext.fillStyle="#000",this.drawContext.fillRect(0,0,this.screenWidth,this.screenHeight),this.renderCeilingFloor(e),this.renderWalls(e),this.mapVisible&&this.renderMap(e)},e.prototype.renderCeilingFloor=function(e){var t=this.getBlockColor(e.ceiling);this.drawContext.fillStyle="hsl("+t.hue+","+t.saturation+"%,"+t.lightness/2+"%)",this.drawContext.fillRect(0,0,this.screenWidth,this.screenHeight/2);var r=this.getBlockColor(e.floor);this.drawContext.fillStyle="hsl("+r.hue+","+r.saturation+"%,"+r.lightness/4+"%)",this.drawContext.fillRect(0,this.screenHeight/2,this.screenWidth,this.screenHeight/2)},e.prototype.renderWalls=function(e){for(var t=0;t<this.screenWidth;t++){var r,i,s,o,n=2*t/this.screenWidth-1,h=e.player.direction.x+e.player.plane.x*n,a=e.player.direction.y+e.player.plane.y*n,l=Math.floor(e.player.posX),d=Math.floor(e.player.posY),p=Math.abs(1/h),u=Math.abs(1/a);h<0?(r=-1,s=(e.player.posX-l)*p):(r=1,s=(l+1-e.player.posX)*p),a<0?(i=-1,o=(e.player.posY-d)*u):(i=1,o=(d+1-e.player.posY)*u);for(var c,y,f=0;0===f;)s<o?(s+=p,l+=r,c=0):(o+=u,d+=i,c=1),e.worldMap[d][l]>0&&(f=1);y=0===c?(l-e.player.posX+(1-r)/2)/h:(d-e.player.posY+(1-i)/2)/a;var w,v=Math.floor(this.screenHeight/y),g=-v/2+this.screenHeight/2+0,x=v/2+this.screenHeight/2+0,C=e.worldMap[d][l]-1;w=0==c?e.player.posY+y*a:e.player.posX+y*h;var m=(w-=Math.floor(w))*this.texWidth;0==c&&h>0&&(m=this.texWidth-m),1==c&&a<0&&(m=this.texWidth-m);var M=Math.floor(this.texWidth+C*this.texWidth-m);this.drawContext.drawImage(this.textures,M,0,1,this.texHeight,t,g,1,x-g),1===c&&(this.drawContext.strokeStyle="rgba(0,0,0,0.6)",this.drawContext.beginPath(),this.drawContext.moveTo(t,g),this.drawContext.lineTo(t,x),this.drawContext.stroke())}},e.prototype.renderMap=function(e){var t=10;this.drawContext.strokeStyle="#f0f";for(var r=0;r<e.worldMap.length;r++)for(var i=0;i<e.worldMap[r].length;i++){var s=this.getBlockColor(e.worldMap[r][i]);this.drawContext.fillStyle="hsl("+s.hue+","+s.saturation+"%,"+s.lightness+"%)",this.drawContext.fillRect(i*t,r*t,t,t),e.currentTileX===i&&e.currentTileY===r&&this.drawContext.strokeRect(i*t,r*t,t,t)}var o=e.player.posX*t,n=e.player.posY*t;this.drawContext.strokeStyle="#fff",this.drawContext.beginPath(),this.drawContext.arc(o,n,5,0,2*Math.PI),this.drawContext.stroke(),this.drawContext.beginPath(),this.drawContext.moveTo(o,n),this.drawContext.lineTo(o+e.player.direction.x*t,n+e.player.direction.y*t),this.drawContext.stroke()},e.prototype.getBlockColor=function(e){var t=0,r=100,s=50;return 0===e?(r=0,s=0):t=40*e,new i.Color(t,r,s)},e}();t.Renderer=s},51:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.rotateBy=function(e){e=-e*(Math.PI/180);var t=Math.cos(e),r=Math.sin(e),i=Math.round(1e4*(this.x*t-this.y*r))/1e4,s=Math.round(1e4*(this.x*r+this.y*t))/1e4;this.x=i,this.y=s},e}();t.Vector=r}},t={};function r(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,r),o.exports}(()=>{var e=r(934),t=r(322),i=r(983),s=new t.Input;s.attachEventListeners(document.getElementsByTagName("body")[0]);var o=document.getElementById("canvas"),n=document.getElementById("textures"),h=new i.Renderer(1024,768,o,n);new e.Game(h,s).tick()})()})();
//# sourceMappingURL=main.bf52fe55506867471371.js.map